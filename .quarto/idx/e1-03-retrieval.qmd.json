{"title":"e1 Retrieval Rate","markdown":{"headingText":"e1 Retrieval Rate","containsRefs":false,"markdown":"\n```{r, message=FALSE}\nlibrary(tidyverse)\nlibrary(ez)\nlibrary(gt)\nlibrary(rsvg)\nlibrary(svglite)\n```\n\nRetrieval Rate is \"How many trees did they visit to get this fruit?\"\n\n```{r}\noptions(contrasts=c(\"contr.sum\",\"contr.poly\"))\noptions(dplyr.summarise.inform=F)\nknitr::opts_chunk$set(message = FALSE)\n```\n\n\n```{r}\nlibrary(tidyverse)\nlibrary(ez)\nlibrary(gt)\npd <- position_dodge(0.1)\n```\n\n\n```{r}\ne1 <- readRDS(\"001-00-e1-data.RDS\")\n\n# remove things from the raw data to make it suitable \n# for this particular analysis\n\n# remove samples that did not look at a tree\ne1 <- e1 %>% \n  filter(fl>0)\n\n# remove the second (and any subsequent) *consecutive* duplicates\ne1 <- e1 %>% \n  filter(is.na(tl != lag(tl)) | tl != lag(tl))\n\n# remove trials where they failed to get 10 fruit\ne1 <- e1 %>% \n  group_by(pp, te) %>% \n  mutate(max_fr = max(fr)) %>% \n  ungroup() %>% \n  filter(max_fr==10) %>% \n  select(-c(max_fr))\n\n\n```\n\nAnnotate: \"How many trees did they visit to get this fruit?\"\n\n```{r}\ne1.retrieval <- e1\ne1.retrieval$n_trees_per_fruit = NA\nj = 0\nfor (k in seq_along(e1.retrieval$ix)) {\n j = j + 1\n if (e1.retrieval[k, 'fl']==2) {\n   e1.retrieval[k, 'n_trees_per_fruit'] = j\n   j = 0\n }\n}\n```\n\nYou don't want to retain zero counts because\nthere is no such thing as 0 for \"How many trees did they visit to get this fruit?\"\n\n```{r}\ne1.retrieval <- e1.retrieval %>%  \n  filter(n_trees_per_fruit != 0)\n```\n\nThe data are valid row-per-sample here.\n\nWe want to collapse to the level of the fruit-seeking event.\n\nBy definition, fr==0 is NA for n_trees_per_fruit -- they haven't got a fruit yet, so they can't have visited any trees to get to no fruit.\n\nThere is no such thing as 0 for \"How many trees did they visit to get this fruit?\" so we don't do anything about having a sparse matrix.\n\nThe minimum number of trees looked at to get a fruit is 1: the look that scored the fruit.\n\n```{r}\ne1.retrieval_per_fruit <- e1.retrieval %>% \n  group_by(across(c(ex,pp,rr,st,tb,fr))) %>% \n  summarise(retrieval_per_fruit = sum(na.rm=T,n_trees_per_fruit))\n```\n\nCollapse over trials to yield average per-fruit n trees\n\n```{r}\ne1.mean_retrieval_per_fruit <- e1.retrieval_per_fruit %>% \n  group_by(across(c(ex,pp,rr, fr))) %>% \n  summarise(mean_retrieval_per_fruit = mean(retrieval_per_fruit))\n```\n\nMake plot data\n\n```{r}\nsaveRDS(e1.mean_retrieval_per_fruit,\"e1_retrieval_plot_data.rds\")\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"e1-03-retrieval.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.313","theme":"cosmo","page-layout":"full"},"extensions":{"book":{"multiFile":true}}}}}